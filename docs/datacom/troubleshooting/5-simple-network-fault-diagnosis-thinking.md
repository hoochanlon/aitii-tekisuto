# 简明网络故障排查思路

**一、目的**

本手册旨在提供一套简易网络故障筛查和处理流程，帮助IT员工快速识别和解决常见问题，确保职场网络的正常运行。

**二、适用范围**

适用于各类职场内所有网络（生产网、办公网、监控网络）常见故障的筛查与处理。

**三、故障筛查**

1、情况确认：确认故障出现的范围、时间，以及原本是否正常。

2、网络信息收集（见下表）：

2.1、ping故障设备所在网段网关  
2.2、ping域控服务器或核心交换机管理地址  
2.3、ping出口设备管理地址或入口地址  
2.4、查询故障电脑网络出口地址（例如 `curl cip.cc`，需防火墙放行该地址）  
2.5、ping出口地址（例如 `ping 8.8.8.8` 或运营商提供的探测地址）  
2.6、tracert/ping 需要访问的系统域名或所需访问地址  
2.7、nslookup 相关系统域名

网络信息收集步骤汇总如下：

| 步骤 | 操作示例 | 目的 |
|------|----------|------|
| 2.1 | `ping 网关 IP` | 确认本机到默认网关 / 核心三层接口是否连通，判断问题是否在本机至核心这一段。 |
| 2.2 | `ping 域控 / 核心管理地址` | 进一步确认本机到核心 / 关键服务器的连通性，用于区分单台故障还是上联 / 路由问题。 |
| 2.3 | `ping 出口设备管理地址 / 入口地址` | 判断核心到出口设备之间是否正常，便于划分「电脑-核心」与「核心-出口」两段分别排查。 |
| 2.4 | `curl cip.cc` 等 | 确认当前使用的公网出口 IP，排查是否与甲方要求的指定出口不符。 |
| 2.5 | `ping 公网探测地址` | 判断从本机经出口到公网的连通性，辅助定位是内网问题还是运营商 / 上级网络问题。 |
| 2.6 | `tracert 目标域名 / IP` | 查看报文每一跳的路径与停滞点，结合设备日志进一步定位在哪一段中断。 |
| 2.7 | `nslookup 系统域名` | 确认 DNS 解析是否正常，区分是网络连通问题还是域名解析问题。 |

3、信息分析：

3.1、网关不通：则故障大概率出现在电脑至核心交换机段，但可能存在内网隔离所以网关不通的情况。

3.2、域控服务器或核心交换机管理地址不通：结合网关不通可确认故障出现在电脑至核心交换机段。

3.3、ping出口设备管理地址或入口地址不通：故障出现在电脑至出口设备段，需要分为电脑-核心、核心-出口两段进行分别排查。

3.4、ping出口地址不通：故障出现在电脑至出口设备段，需要分为电脑-核心、核心-出口，以及防火墙策略三段进行分别排查。

3.5、tracert/ping需要访问的系统域名或所需访问地址以及nslookup相关系统域名，主要为查询DNS服务器以及路由路径是否正常。

4、IP 冲突排查思路（核心 → 汇聚 → 接入）：

4.1、在核心交换机 / 网关设备上排查  
- 通过 ARP 表或 IP-MAC 绑定记录，找到出现告警或怀疑冲突的 IP 地址对应的 MAC 地址，以及该 MAC 所在的下联接口（通常是到汇聚的聚合口 / 上联口）。  
- 记录下该 MAC 地址和下联接口，为下一步在汇聚设备上继续追踪做准备。

4.2、在汇聚交换机上继续定位  
- 登录对应汇聚交换机，查询 MAC 地址表，查找上一步记录的 MAC。  
- 根据 MAC 所在端口判断：  
  - 若端口是下联到接入交换机的上联口，则记下目标接入交换机，再在该接入交换机上继续追踪；  
  - 若端口直接连接终端（少见），则故障点已基本锁定在该终端或该端口。

4.3、在接入交换机上精确到端口  
- 在接入交换机上查询 MAC 地址表，定位该 MAC 所在的具体接入端口。  
- 结合端口描述、配线标签或现场寻线，找到对应的工位 / 设备，核实是否存在：  
  - 终端手工配置了与他人重复的静态 IP；  
  - 违规接入了小交换机 / 路由器并开启了 DHCP；  
  - 其他异常设备占用了不该使用的地址。

4.4、配合地址管理进行确认  
- 若存在 DHCP 服务器或 IP 地址管理表，可同时核对该 IP 是否被多处静态配置，或是否存在重复租约。  
- 处理冲突终端后，清理相关 ARP / DHCP 记录，并再次通过网关 / 核心设备确认 ARP 表已恢复正常。

**四、故障案例**

例1、报修内容：生产职场一台电脑无网络，无法访问业务地址。

收到报修后首先收集信息：

故障为单台电脑，该电脑之前可以正常使用，下面进行故障电脑测ping

  Ping 网关-不通

  Ping域控服务器-不通

  核心交换机Ping防火墙管理地址-通

分析：

电脑至核心交换机不通，但核心交换机至防火墙是通的，所以故障可锁定在电脑至核心交换机。又因故障为单台电脑非批量故障，则问题出现在该电脑至核心交换机这一段。

电脑至核心交换机这一段可拆解为：电脑故障、网线故障、面板故障、交换机接口故障

处理：

确认是否为电脑故障，同时进行寻线/对线，确认物理连接是否正常，进入接入交换机内部查看该配置是否正确，以及测试接口是否正常。

 

例2、报修内容：生产职场一台电脑无网络，无法访问业务地址。

收到报修后首先收集信息：

故障为单台电脑，该电脑之前无人使用，下面进行故障电脑测 ping：

  Ping 网关 - 不通  
  Ping 域控服务器 - 通  
  Ping 防火墙管理地址 - 通  
  Ping 出口地址 - 通  
  Ping 业务地址 - 不通  
  tracert 业务地址

分析：

电脑至防火墙出口地址网络均是通的，但是至甲方业务地址不通，不通的原因可能有 DNS 地址解析的原因，出口地址不符合甲方要求（甲方指定出口地址）或防火墙策略问题。

处理：确认该业务地址的特殊性是否需要特定的出口等，同时确认故障电脑是否满足其特殊性。  
同时在防火墙上查询是否被拦截，是否因策略问题导致无法访问。

---

**五、不同影响范围下的排查与处理思路**

以上案例主要针对“单台电脑”的情况，实际工作中还会遇到“某个人没网、一个办公区没网、一整层楼没网”等不同范围的故障。第一步始终是**先判断影响范围，再决定从哪一层开始查**。

### 1. 个人没网（单点问题）

**典型现象：** 只有某一台电脑上不了网，同一工位附近或同 VLAN 其他电脑正常。

**排查步骤示例：**

1. **本机自查**：确认网线是否插好，网卡状态是否启用，IP/掩码/网关配置是否正确（是否手工配置成了奇怪的静态 IP）。  
2. **按“三、故障筛查”的 2.1～2.7 依次测试**：从 ping 网关开始，逐级往外测试到出口 / 业务地址。  
3. **结合例 1 / 例 2 分析**：  
   - 到网关都不通，而同 VLAN 其他机器正常，多半是本机 / 网线 / 面板 / 接入交换机端口问题；  
   - 到出口都通，只是访问特定业务不通，多半是 DNS、指定出口或防火墙策略问题。  
4. **在接入交换机上看端口与 MAC**：确认端口是否 up、VLAN 是否正确、是否被 shutdown、是否存在 IP 冲突（可结合“4、IP 冲突排查思路”按 MAC 往回追）。  

**处理建议：**

- 优先排除本机配置与物理链路问题（换线、换口、临时改为自动获取 IP 测试等）；  
- 如判断为 IP 冲突或端口配置问题，则按“核心 → 汇聚 → 接入”的方法定位到具体端口 / 设备，再做整改。

### 2. 办公区没网（同一接入交换机范围）

**典型现象：** 某一片区域或同一配线架 / 接入交换机下的多台电脑同时没网，而其他区域正常。

**排查步骤示例：**

1. **确认范围**：抽查几台在该区域不同工位的电脑，看是否同样上不了网；同时对比相邻区域是否正常，从而判断是否集中在某一台接入交换机或某一 VLAN。  
2. **从核心 / 汇聚侧检查该接入交换机**：  
   - 在核心 / 汇聚上 ping 该接入交换机管理地址，看是否在线；  
   - 查看到该接入交换机的上联口状态（up/down）、链路聚合状态、Trunk 放行 VLAN 是否异常。  
3. **登录接入交换机检查**：  
   - 看下联端口是否大面积 down；  
   - 端口 VLAN 配置是否被误改；  
   - 是否有环路保护触发导致端口被阻断（如 STP、环路检测告警）。  
4. **必要时做临时旁路测试**：  
   - 选一台故障电脑，临时拉一根网线直连到临近正常区域的交换机端口，看是否恢复；  
   - 可以帮助确认问题是否集中在某一台接入设备 / 上联链路。  

**处理建议：**

- 若仅上联口异常（光纤断、模块故障、Trunk 配置错误），优先恢复上联链路；  
- 若整台接入交换机异常（掉电、硬件故障），可考虑临时旁路连接关键工位，后续再安排更换设备。  

### 3. 一层楼办公室没网（楼层 / 汇聚级问题）

**典型现象：** 整层楼或大部分办公室突然全部没网，而其他楼层或机房仍正常。

**排查步骤示例：**

1. **快速确认影响范围**：与其他楼层值班人员核对，确认是否仅该层受影响；检查该层不同网络（办公网、生产网、监控网）是否同时受影响。  
2. **从核心设备看楼层汇聚状态**：  
   - 在核心上 ping 楼层汇聚交换机管理地址；  
   - 检查核心到该楼层汇聚的上联口 / 聚合口状态、Trunk / VLAN 配置是否异常；  
   - 查看路由 / VRRP / 堆叠状态是否异常切换。  
3. **到楼层汇聚或弱电间实地检查**：  
   - 设备是否掉电（配电箱、UPS 输出）；  
   - 机房 / 弱电间是否有人施工（装修、布线）导致光纤或网线受损；  
   - 楼层汇聚到各接入交换机的下联是否大面积 down。  
4. **必要时从“上往下逐级恢复”**：  
   - 先保证核心 ↔ 楼层汇聚链路恢复；  
   - 再检查楼层汇聚 ↔ 各接入交换机；  
   - 最后再看单个办公区 / 工位的问题。  

**处理建议：**

- 把“一层楼没网”当作**汇聚 / 楼层级事件**来处理，优先恢复核心与该楼层之间的主干连接；  
- 在恢复主干后，再根据是否还有“个别办公区”或“个别个人”有问题，套用上面 **2 / 1** 的思路继续往下细分。  

通过先判断影响范围，再结合前面的“ping 路径 + 核心 / 汇聚 / 接入”排查方法，可以把看似复杂的网络故障拆解成可控的几段，逐层定位、逐层恢复。

---

**六、思路总结**

可以把整个排查过程记成四句话：

1. **先定范围**：是一台电脑、一个办公区，还是一层楼 / 多个网络一起出问题。  
2. **再看路径**：按“本机 → 网关 → 核心 / 域控 → 出口设备 → 公网 / 业务系统”依次 ping / tracert / nslookup，找出第一跳异常点。  
3. **按段定位**：结合测试结果，把问题归类到“本机 / 物理链路 / 接入交换机 / 汇聚 / 核心 / 出口 / DNS / 策略”等其中一段。  
4. **自上而下细化**：对成片或整层故障，从核心 / 汇聚开始往下查；对单点或 IP 冲突，从接入端口和终端往上追，必要时用“核心 → 汇聚 → 接入”的 MAC / ARP 追踪方法精确到工位。

在实际一线排障时，可以进一步把上面的思路压缩成一套「三步快排」小口诀：

1. **30 秒定范围**：先问清 / 验证是单台、单区还是整层甚至多网一起异常，同时找一台你确认正常的对比机器做快测。  
2. **3 个关键 ping 定断点**：在故障机器上至少做：`ping 网关`、`ping 核心 / 域控`、`ping 出口地址（或 8.8.8.8）`，看哪一跳**第一次**不通，把问题先粗分到“本机 / 接入”、“核心 / 汇聚”还是“出口 / 防火墙 / 运营商 / 目标系统”。  
3. **设备侧反查一眼**：根据第二步的判断，立刻到对应的交换机 / 防火墙上看一眼端口状态、VLAN/Trunk、告警与日志（例如：单点问题看接入端口，多区问题看接入上联，一层全挂看楼层汇聚和核心到汇聚的主干链路）。

只要坚持“**先范围 → 再路径 → 再设备侧反查**”这一套，不急着一上来就改配置，大多数看似复杂的网络故障都可以在 1～2 分钟内缩小到某一段，再按前文的详细步骤按图索骥地逐个排除。